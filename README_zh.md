# Elasticsearch è—æ–‡åˆ†è¯æ’ä»¶

**è¯­è¨€é€‰æ‹©:** [English](./README.md) | [ä¸­æ–‡ç‰ˆ](#elasticsearch-è—æ–‡åˆ†è¯æ’ä»¶)

---

åŸºäºè¯å…¸çš„è—æ–‡åˆ†è¯å™¨æ’ä»¶ï¼Œæ”¯æŒ Elasticsearch 8.7+ï¼Œé‡‡ç”¨æœ€é•¿åŒ¹é…ç®—æ³•ã€‚

## ç‰¹æ€§

- âœ… è¯å…¸åˆ†è¯ï¼ˆ65,000+ è¯æ¡ï¼‰
- âœ… æœ€é•¿åŒ¹é…ç®—æ³•
- âœ… è—æ–‡è¯­æ³•åç¼€å¤„ç†
- âœ… è‡ªå®šä¹‰è¯å…¸æ”¯æŒ
- âœ… Docker æµ‹è¯•ç¯å¢ƒ

## Docker å¿«é€Ÿå¼€å§‹

æœ€å¿«çš„æµ‹è¯•æ–¹å¼ï¼š

```bash
# å¯åŠ¨ Elasticsearch + Kibana + è—æ–‡åˆ†è¯å™¨
docker-compose up -d

# ç­‰å¾…æœåŠ¡å°±ç»ªï¼ˆçº¦30ç§’ï¼‰
docker-compose ps

# æµ‹è¯•åˆ†è¯
curl -X POST "http://localhost:9200/_analyze" -H 'Content-Type: application/json' -d '{
  "analyzer": "tibetan_analyzer",
  "text": "à½„à¼‹à½šà½¼à½¦à¼‹à½¦à¾³à½¼à½–à¼‹à½‚à¾²à¾­à½¢à¼‹à½ à½‚à¾²à½¼à¼‹à½‘à½‚à½¼à½¦à¼"
}'

# è®¿é—® Kibana Dev Tools
# http://localhost:5601/app/dev_tools#/console

# åœæ­¢æœåŠ¡
docker-compose down
```

**é»˜è®¤æ•°æ®**ï¼šå¯åŠ¨æœåŠ¡æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹ç´¢å¼•ï¼š
- **tibetan_docs**: 5 æ¡ç®€å•æ¼”ç¤ºæ–‡æ¡£ï¼ˆé—®å€™è¯­å’Œå¸¸ç”¨çŸ­è¯­ï¼‰
- **tibetan_qa**: 2000 æ¡ç»¼åˆé—®ç­”ï¼ˆå†å²ã€æ–‡åŒ–ã€åœ°ç†ç­‰ï¼‰
- **tibetan_medical_qa**: 239 æ¡ä¼ ç»Ÿè—åŒ»çŸ¥è¯†é—®ç­”

æ‰€æœ‰æ•°æ®åœ¨é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨å¯¼å…¥ - æ— éœ€é¢å¤–æ­¥éª¤ï¼

## ğŸ“– æ–‡æ¡£

å®Œæ•´æ–‡æ¡£ä½äº `docs/` ç›®å½•ï¼š

- **[å¿«é€Ÿå¼€å§‹æŒ‡å—](./docs/quick-start.md)** - 5åˆ†é’Ÿè®¾ç½®
- **[æŸ¥è¯¢ç¤ºä¾‹](./docs/query-examples.md)** â­ - å¯ç›´æ¥ä½¿ç”¨çš„ Kibana æŸ¥è¯¢
- **[åˆ†è¯å™¨ä½¿ç”¨](./docs/analyzer-usage.md)** - åˆ†è¯å™¨å·¥ä½œåŸç†
- **[API å‚è€ƒ](./docs/api-reference.md)** - å®Œæ•´ API æ–‡æ¡£

**æ–°ç”¨æˆ·ï¼š** ä»[å¿«é€Ÿå¼€å§‹æŒ‡å—](./docs/quick-start.md)å¼€å§‹ï¼Œç„¶ååœ¨ Kibana Dev Tools ä¸­å°è¯•[æŸ¥è¯¢ç¤ºä¾‹](./docs/query-examples.md)ï¼

### å¿«é€Ÿæœç´¢ç¤ºä¾‹

```bash
# ç»Ÿè®¡å„ç´¢å¼•æ–‡æ¡£æ•°
curl "http://localhost:9200/tibetan_docs/_count"        # 5 æ¡
curl "http://localhost:9200/tibetan_qa/_count"          # 2000 æ¡
curl "http://localhost:9200/tibetan_medical_qa/_count"  # 239 æ¡

# æœç´¢ç»¼åˆé—®ç­”
curl -X POST "http://localhost:9200/tibetan_qa/_search" -H 'Content-Type: application/json' -d '{
  "query": {"match": {"question": "à½£à½¼à¼‹à½¢à¾’à¾±à½´à½¦"}},
  "size": 5
}'

# æœç´¢è—åŒ»é—®ç­”
curl -X POST "http://localhost:9200/tibetan_medical_qa/_search" -H 'Content-Type: application/json' -d '{
  "query": {"match": {"question": "à½¦à¾™à½²à½„à¼‹à½‚à½Ÿà½ºà½¢"}},
  "size": 3
}'

# å¤šå­—æ®µæœç´¢
curl -X POST "http://localhost:9200/tibetan_qa/_search" -H 'Content-Type: application/json' -d '{
  "query": {
    "multi_match": {
      "query": "à½–à½¼à½‘à¼‹à½€à¾±à½²à¼‹à½£à½¼à¼‹à½¢à¾’à¾±à½´à½¦",
      "fields": ["title", "content", "question", "answer"]
    }
  },
  "size": 10
}'
```

## æ ·æœ¬æ•°æ®

æ‰€æœ‰æµ‹è¯•æ•°æ®å·²é¢„ç”Ÿæˆå¹¶åŒ…å«åœ¨ `docker/` ç›®å½•ä¸­ï¼š

| æ–‡ä»¶ | å¤§å° | è®°å½•æ•° | è¯´æ˜ | ç´¢å¼•åç§° |
|------|------|--------|------|----------|
| `docker/sample-data.json` | 1.3KB | 5 | æ¼”ç¤ºé—®å€™è¯­å’ŒçŸ­è¯­ | `tibetan_docs` |
| `docker/tibetan-qa-data.json` | 6.7MB | 2000 | ç»¼åˆçŸ¥è¯†é—®ç­”ï¼ˆå†å²ã€æ–‡åŒ–ã€åœ°ç†ï¼‰ | `tibetan_qa` |
| `docker/tibetan-medical-qa-data.json` | 290KB | 239 | ä¼ ç»Ÿè—åŒ»çŸ¥è¯†é—®ç­” | `tibetan_medical_qa` |

**æ•°æ®æ¥æºï¼š**
- ç»¼åˆé—®ç­”ï¼šæ¥è‡ªå…¬å¼€è—æ–‡çŸ¥è¯†åº“
- è—åŒ»é—®ç­”ï¼šæå–è‡ªä¼ ç»Ÿè—åŒ»æ–‡çŒ®ï¼ˆà½‚à½¦à½¼à¼‹à½¢à½²à½‚à¼‹à½¢à¾’à¾±à½´à½“à¼‹à½¤à½ºà½¦à¼ï¼‰

**æ³¨æ„ï¼š** è½¬æ¢è„šæœ¬ï¼ˆ`convert-qa-csv.py`ã€`convert-medical-qa.py`ï¼‰å·²åŒ…å«ä¾›å‚è€ƒï¼Œä½†æ­£å¸¸ä½¿ç”¨æ— éœ€è¿è¡Œã€‚

## ä»æºç æ„å»º

### ç¯å¢ƒè¦æ±‚

- Java 17+
- Gradle 8.0+

### æ„å»ºæ­¥éª¤

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/TocharianOU/elastic-tibetan-analyzer.git
cd elastic-tibetan-analyzer

# æ„å»ºæ’ä»¶
./gradlew clean build

# æ’ä»¶æ–‡ä»¶ä½ç½®ï¼š
# - build/distributions/tibetan-analyzer-plugin-v1.0-es8.7+.zip
# - releases/v1.0-es8.7+/
```

## æ‰‹åŠ¨å®‰è£…

### å®‰è£…æ’ä»¶

```bash
# ä»æœ¬åœ°æ–‡ä»¶å®‰è£…
bin/elasticsearch-plugin install file:///path/to/tibetan-analyzer-plugin-v1.0-es8.7+.zip

# é‡å¯ Elasticsearch
```

### åˆ›å»ºä½¿ç”¨è—æ–‡åˆ†è¯å™¨çš„ç´¢å¼•

```json
PUT /tibetan_test
{
  "settings": {
    "analysis": {
      "analyzer": {
        "my_tibetan": {
          "type": "tibetan_analyzer"
        }
      }
    }
  },
  "mappings": {
    "properties": {
      "content": {
        "type": "text",
        "analyzer": "my_tibetan"
      }
    }
  }
}
```

### æµ‹è¯•åˆ†è¯

```json
POST /_analyze
{
  "analyzer": "tibetan_analyzer",
  "text": "à½–à½€à¾²à¼‹à½¤à½²à½¦à¼‹à½–à½‘à½ºà¼‹à½£à½ºà½‚à½¦à¼"
}
```

**ç»“æœï¼š**
```json
{
  "tokens": [
    { "token": "à½–à½€à¾²à¼‹à½¤à½²à½¦à¼‹à½–à½‘à½ºà¼‹à½£à½ºà½‚à½¦", "position": 0 },
    { "token": "à¼", "position": 1 }
  ]
}
```

## åˆ†è¯ç¤ºä¾‹

| è¾“å…¥ | åˆ†è¯ç»“æœ | ç¿»è¯‘ |
|------|---------|------|
| `à½„à¼‹à½šà½¼à½¦à¼‹à½¦à¾³à½¼à½–à¼‹à½‚à¾²à¾­à½¢à¼‹à½ à½‚à¾²à½¼à¼‹à½‘à½‚à½¼à½¦à¼` | `à½„à¼‹à½šà½¼` `à½¦` `à½¦à¾³à½¼à½–à¼‹à½‚à¾²à¾­` `à½¢` `à½ à½‚à¾²à½¼à¼‹à½‘à½‚à½¼à½¦` `à¼` | æˆ‘ä»¬å»å­¦æ ¡ |
| `à½„à½ à½²à¼‹à½•à¼‹à½˜à¼‹à½‚à½‰à½²à½¦à¼‹à½‘à½‚à½¼à½“à¼‹à½”à½¢à¼‹à½•à¾±à½²à½“à¼‹à½”à¼‹à½¢à½ºà½‘à¼` | `à½„` `à½ à½²` `à½•à¼‹à½˜` `à½‚à½‰à½²à½¦` `à½‘à½‚à½¼à½“à¼‹à½”` `à½¢` `à½•à¾±à½²à½“à¼‹à½”` `à½¢à½ºà½‘` `à¼` | æˆ‘çš„çˆ¶æ¯å»äº†å¯ºé™¢ |
| `à½–à½¼à½‘à¼‹à½€à¾±à½²à¼‹à½£à½¼à¼‹à½¢à¾’à¾±à½´à½¦à¼` | `à½–à½¼à½‘` `à½€à¾±à½²` `à½£à½¼à¼‹à½¢à¾’à¾±à½´à½¦` `à¼` | è¥¿è—å†å² |

## ç®—æ³•åŸç†

- **æœ€é•¿åŒ¹é…åˆ†è¯**ï¼šä¼˜å…ˆåŒ¹é…é•¿è¯ï¼ˆ4â†’3â†’2â†’1 éŸ³èŠ‚ï¼‰
- **è¯å…¸æŸ¥è¯¢**ï¼š65,000+ è¯æ¡è¦†ç›–å¤šä¸ªç±»åˆ«
- **åç¼€å¤„ç†**ï¼šè‡ªåŠ¨åˆ†ç¦»è¯­æ³•åŠ©è¯ï¼ˆà½¦, à½¢, à½ à½² ç­‰ï¼‰
- **Unicode æ”¯æŒ**ï¼šæ­£ç¡®å¤„ç†è—æ–‡ç»„åˆå­—ç¬¦

## è‡ªå®šä¹‰è¯å…¸

åœ¨ `src/main/resources/dictionaries/custom_dictionary.txt` æ·»åŠ è‡ªå®šä¹‰è¯æ±‡ï¼ˆæ¯è¡Œä¸€ä¸ªè¯ï¼‰ï¼š

```
à½–à½¼à½‘à¼‹à½£à¾—à½¼à½„à½¦à¼‹
à½¢à¾’à¾±à½£à¼‹à½¦à¼‹
à½£à¾·à¼‹à½¦à¼‹
```

æ·»åŠ åéœ€é‡æ–°æ„å»ºæ’ä»¶ã€‚

## è¯å…¸ç»Ÿè®¡

- åŠ¨è¯ï¼š3,117
- å•éŸ³èŠ‚è¯ï¼š1,560
- åŒéŸ³èŠ‚è¯ï¼š38,647
- ä¸‰éŸ³èŠ‚è¯ï¼š11,663
- å››éŸ³èŠ‚è¯ï¼š10,232
- è™šè¯ï¼š38
- åç¼€ï¼š10

## å…¼å®¹æ€§

- Elasticsearch: 8.7.0+
- Lucene: 9.5+
- Java: 17+

## è®¸å¯è¯

Apache License 2.0

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼šhttps://github.com/TocharianOU/elastic-tibetan-analyzer

---

**æ³¨æ„**ï¼šæœ¬æ’ä»¶ä½¿ç”¨è¯å…¸åˆ†è¯ã€‚å¯¹äºç‰¹å®šé¢†åŸŸæ–‡æœ¬ï¼Œå»ºè®®æ·»åŠ è‡ªå®šä¹‰è¯æ±‡åˆ°è¯å…¸ä»¥è·å¾—æœ€ä½³æ•ˆæœã€‚
